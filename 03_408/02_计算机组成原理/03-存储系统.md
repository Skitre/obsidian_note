## 概述
### 存储器分类
#### 按作用分类
- **主存储器（主存）**
	- 也称内存储器 (内存)，用来存放计算机运行期间所需的*程序和数据*，CPU 可以*直接、随机*地对其进行访问，也可以和高速缓冲存储器 ( Cache ) 及辅助存储器交换数据
	- 容量较小，存取速度较快，每位的价格较高
- **辅助存储器** 
	- 也称外存储器或外存，用来存放当前暂时不用的程序和数据，以及一些需要永久性保存的信息
	- 辅存的内容需要*调入主存后才能被 CPU 访问*
	- 容量大，存取速度较慢，单位成本低
- **高速缓冲存储器**（cache）
	- 位于主存和 CPU 之间，用来存放当前 CPU 经常使用的指令和数据，以便 CPU 能高速地访问它们
	- Cache 的存取速度可与 CPU 的速度相匹配
	- 存储容量小，价格高，通常制作在 CPU 中
#### 按存储介质分类
- 按存储介质，存储器可分为*磁表面存储器* (磁盘、磁带)、*磁芯存储器*、*半导体存储器* (MOS型存储器、双极型存储器)和*光存储器* (光盘)
#### 按信息保存性分类
- **易失性存储器**
	- 断电后，存储信息消失的存储器，如 RAM
- **非易失性存储器**
	- 断电后信息依然保持的存储器，如 ROM磁表面存储器、光存储器
### 存储器的性能指标与单位
- 性能指标
	- 存储容量
	- 单位成本
	- 存储速度
		- 存取时间 $T_a$：指从*启动一次存储器*操作到*完成该操作*所经历的时间，分为读出时间和写入时间
		- 存取周期 $T_m$：指存储器进行*一次完整的读/写操作*所需的全部时间，即连续两次独立访问存储器操作 (读或写操作) 之间所需的*最小时间间隔*
		- 主存带宽 $B_m$：也称之为数据传输速率，表示每秒从主存进出信息的最大数量，单位为字/秒，字节/秒，位/秒
		- ![[Pasted image 20250706143024.png]]
### 多级层次的存储系统
- Cache 、主存能与 CPU 直接交换信息
- 辅存需要通过主存和 CPU 交换信息
- 主存与 CPU、Cache、辅存都能交换信息
- 上一层的存储器作为低一层存储器的高速缓存
- 分析
	- 读取过程
		- 当 CPU 要从存储器中存取数据时，先访问 Cache
		- 若不在 Cache 中，则访问主存
		- 若不在主存中，则访问磁盘
		- 此时，操作数从磁盘读出送到主存，然后从主存送到 Cache
	- CPU 的角度
		- Cache - 主存层
			- 速度接近于 Cache ，容量和位价却接近于主存
			- 主要解决 CPU 和主存速度不匹配的问题，且其过程由硬件实现、对程序员透明
		- 主存 - 辅存层
			- 速度接近于主存，容量和价格却接近辅存
			- 其使用虚拟存储技术，使得这个系统中程序员的可编程地址范围和虚拟存储器地址对应，扩大了编程时可用的地址空间，其远大于主存空间
	- 这样解决了速度、容量、成本三者的矛盾
	- ![[Pasted image 20250706143412.png]]
## 存储器
### 存储系统的硬件分类
- ![[Pasted image 20250706144210.png]]
- 随机存储器 RAM
	- 任何一个单元都能随机存取，存取时间与存储单元的位置无关
	- 主要用途是高速缓存或主存
	- 分为 DRAM 和 SRAM，前者以触发器原理寄存信息，后者以电容充电原理寄存信
- 只读存储器 ROM
	- 数据一次写入存储器后不能修改，只能读取，断电不易失
	- 通常用来存储不变的常数、程序
	- 它和 RAM 一起作为主存的一部分，由 ROM 派生出的存储器，有的是可读可写的，但写速比读的速度要慢得多
- 串行访问存储器
	- 对存储单元的读写要按照物理位置的先后顺序寻址
	- 它包括顺序存取存储器和直接存取存储器。前者的代表是磁带，后者的代表是磁盘
### 半导体随机存取存储器
- 半导体存储器分为随机存储器 ( RAM ) 和只读存储器 ( ROM )，而 RAM 又分为静态随机存储器( SRAM ) 和动态随机存储器 ( DRAM )
- 主存储器主要由 DRAM 实现，靠近处理器的那一层 ( Cache ) 则由 SRAM 实现
- 它们都是易失性存储器，只有 ROM 是非易失性存储器；
- **RAM**
	- 存储器的任何一个存储单元都可以随机存取，而且存取时间与存储单元的物理位置无关
	- 读/写方便，使用灵活
	- 主要用作主存或高速缓冲存储器
	- RAM 又分为静态 RAM 和动态 RAM
- **SRAM**
	- 原理
		- *不需要刷新电路，掉电丢失数据* -> 易失型
		- 其存储元是用*双稳态触发器* (六晶体管 MOS ) 来记忆信息的
		- 静态是指即使信息被读出后，它仍*保持其原状态*、不需要再生 (*非破坏性读出*)
	- 特点
		- SRAM 的存取速度快，但集成度低，功耗较大，价格昂贵
	- 应用
		- 一般用于高速缓冲存储器
		- 目前 SRAM 基本上只用于 CPU 内部的一级缓存以及内置的二级缓存
		- 仅有少量的网络服务器以及路由器上能够使用 SRAM 
- **DRAM**
	- 掉电丢失数据，每隔一段时间就要*刷新*一次数据，才能保存数据
	- 原理
		- 存储原理
			- 动态随机存储器 ( DRAM ) 是利用存储元电路中栅极电容上的电荷来存储信息的，有电荷代表 1，无电荷代表 0
			- DRAM 的基本存储元通常只使用一个晶体管，所以它比 SRAM 的密度要高的多
		- 漏电
			- 栅极会漏电，时间一长，代表 1 的电容会放电，代表 0 的电容会吸收电荷，这就是数据丢失的原因
			- 所以每隔一定的时间就需要一个*刷新机构给这些栅电容补充电荷*
		- 动态刷新
			- *每读出一次数据*之后也需要补充电荷，这个就叫动态刷新，所以称其为动态随机存储器
			- DRAM 的刷新*按照行*为单位
			- 刷新操作定期对电容进行检查:
				- 若电量大于满电量的 1/2，则认为其代表 1 ，并把电容充满电
				- 若电量小于 1/2，则认为其代表 0 ，并把电容放电，藉此来保持数据的连续性
	- 特点
		- 相对于 SRAM 来说， DRAM 具有集成度高、位价低和功耗低等优点
		- 但 DRAM 的存取速度比 SRAM 慢，且必须定时刷新和读后再生，不过它还是比任何的 ROM 都要快
	- ![[Pasted image 20250706145847.png]]
- ![[Pasted image 20250706145907.png]]
- **SDRAM**
	- SDRAM 主要就是在 DRAM 的基础上，比它多了一个与 CPU 时钟同步
	- DRAM 在和 CPU 工作时，CPU 不能做其他事情，但 SDRAM 因为增加了时钟同步，在读写时 CPU 可以做其他事
	- 分析：
		- DRAM 与 CPU 采用*异步*的方式交换数据
			- 在 CPU 发出地址和控制信号后，经过一段延迟时间，数据才读出或写入，在*读写完成前 CPU 不能做其他事情*
		- SDRAM 与 CPU采用*同步*的方式交换数据
			- 将 CPU 发出的*地址和控制信号*锁存起来， CPU 在其读/写完成之前可进行其他操作
			- SDRAM 的每一步操作都在系统时钟的控制下进行，*支持突发传输方式*
	- SDRAM 的突发传输方式
		- 第一次存取时给出首地址，同一行的所有数据都被送到行缓冲器, 因此以后每个时钟都可以连续地从 SDRAM 输出一个数据
		- 突发 (猝发) 传送方式能够进行连续成组数据的传送，其寻址阶段发送的是连续数据单元的首地址，在传输阶段传送多个连续单元的数据，每个时钟周期可以传送一个字长的信息，但是不释放总线，直到一组数据全部传送完毕后，再释放总线
	- 一般的嵌入式产品里面、内存使用的是 SDRAM
- **DDR RAM** (Data-Rate Ram ，也称作 DDR SDRAM )
	- 这种改进型的 RAM 和 SDRAM 是基本一样的，不同之处在于它*可以在一个时钟读写两次数据*，这样就使得数据传输速度加倍了
	- 目前电脑中用得最多的内存，在很多高端的显卡上，也配备了高速 DDR RAM 来提高带宽，这可以大幅度提高 3D 加速卡的像素渲染能力
- **DRAM 的刷新策略**
	- 集中刷新
		- 在一个刷新周期内，利用一段固定的时间，依次对存储器的所有行进行逐一再生，在此期间停止对存储器的读/写操作，称为*死时间*，也称*访存死区*
		- 读/写操作时不受刷新工作的影响
		- 但在集中刷新期间 (死区) 不能访问存储器
	- 分散刷新
		- 将一个存储器系统的工作周期分为两部分，前半部分用于正常的读写操作，后半部分用于刷新
		- *加长了系统的存取周期*
		- 没有死区
	- 异步刷新
		- 结合了前两种方法，使得在*一个刷新周期内每一行仅刷新一次*
		- 具体做法是*将刷新周期除以行数*，得到相邻两行之间刷新的时间间隔，每隔时间产生一次刷新请求
		- 使“死时间”的分布更加分散，避免让 CPU 连续等待过长的时间
	- 注：
		- 刷新对 CPU 是透明的，即刷新*不依赖于外部的访问*
		- DRAM 的刷新单位是行，芯片内部*自动生成行地址*
			- 比如当前是 2048 * 2048 * 4b 的芯片，则只需要 2048 次刷新，便可以将整个存储器刷新一遍
		- 刷新操作类似于读操作，但并不一样
		- 刷新时不需要选片，整个存储器的*所有芯片被同时刷新*
		- 虽然 DRAM 的刷新和再生都是恢复数据，但刷新与再生的过程并不完全相同：*刷新是以行为单位*，逐行恢复数据的，而再生*仅需恢复被读出的那些单元*的数据
- **ROM**
	- ROM为非易失性存储器。ROM不需要刷新。 位密度：ROM>DRAM>SRAM
	- MROM
		- 掩模式只读存储器厂家按照客户需求，在芯片生产过程中直接写入信息，之后任何人不可重写(只能读出) 可靠性高、灵活性差、生产周期长、只适合批量定制	
	- PROM
		- 可编程只读存储器用户可用专门的PROM写入器写入信息，写一次之后就不可更改	
	- EPROM
		- 可擦除可编程只读存储器允许用户写入信息，之后用某种方法擦除数据，可进行多次重写不可做为随机存储器——编程次数有限，写入时间长 
	- Flash
		- 闪速存储器【U盘、SD卡就是闪存】 在EEPROM基础上发展而来，断电后也能保存信息，且可进行多次快速擦除重写注意：由于闪存需要先擦除再写入，因此闪存的“写”速度要比“读”速度更慢。
	- SSD
		- 固态硬盘由控制单元+存储单元（Flash芯片）构成，与闪速存储器的核心区别在于控制单元不一样，但存储介质都类似，可进行多次快速擦除重写。SSD速度快、功耗低、价格高。目前个人电脑常用SSD取代传统的机械硬盘
	- PS
		- 计算机中重要的ROM： 
			- 操作系统安装在辅存之中 
			- CPU的任务：
				- 到主存中取指令并执行指令
			- 主板上的BIOS芯片（ROM），存储了“自举装入程序”，负责引导装入操作系统（开机） 逻辑上，主存由RAM+ROM组成，且二者常**统一编址**
